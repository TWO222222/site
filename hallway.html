<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hallway</title>
    <link rel="stylesheet" href="css files/css.css">
</head>
<div class="idk">
    <video id="hall" src="vid e o and Img/hallway/hallwayfinal.mp4"></video>
</div>
<body>
    
    <a href="file:///C:/Users/sasas/Desktop/without/online/home.html" style="display:block">
        <div class="clickPoly" id="IsoD" style="clip-path: polygon(50% 84%, 50% 13%, 70% 13%, 70% 84%);"></div>
    </a>
    <a href="file:///C:/Users/sasas/Desktop/without/online/cam.html" style="display:block">
        <div class="clickPoly" id="IsoF" style="clip-path: polygon(50% 84%, 50% 13%, 70% 13%, 70% 84%);"></div>
    </a>
    <a href="file:///C:/Users/sasas/Desktop/without/online/kit.html" style="display:block">
        <div class="clickPoly" id="IsoG" style="clip-path: polygon(50% 84%, 50% 13%, 70% 13%, 70% 84%);"></div>
    </a>

    
    <a href="file:///C:/Users/sasas/Desktop/without/online/hallway.html" style="display:block">
        <div class="door" id="dor"></div>
    </a>


    <script>
        // for the scroll wheel scrolling left/right
        const vid = document.getElementById('hall')
        var percent = 1 * sessionStorage.getItem('time')
        console.log(percent)
        window.onwheel = side2side;

        function side2side(event) {


            percent += event.deltaY * 0.0002;
            if (percent >= 1) {
                percent = 1;
            }
            else if (percent <= 0) {
                percent = 0;
            }
		    vid.currentTime = vid.duration - (percent * vid.duration)

        }

        vid.onloadeddata = () => {
            vid.classList.add('visible')
            vid.currentTime = percent * vid.duration
        }

        //for the moving polys
    
        setInterval(function() {
            console.log(vid.currentTime);
            ti = (vid.currentTime * 32.5);
            st = 9;
            st2 =  130;
            st3 =  144.5;
            document.getElementById('IsoD').style.height = vid.height + ('px');
            document.getElementById('IsoD').style.clipPath = "polygon("+ (ti - (10 + st)) +"% 91%,"+ (ti - (10 + st)) +"% 13%,"+ (ti - (30 + st)) +"% 13%,"+ (ti - (30 + st)) +"% 91%)";
            document.getElementById('IsoF').style.height = vid.height + ('px');
            document.getElementById('IsoF').style.clipPath = "polygon("+ (ti - (10 + st2)) +"% 91%,"+ (ti - (10 + st2)) +"% 13%,"+ (ti - (5 + st2)) +"% 13%,"+ (ti - (5 + st2)) +"% 91%)";
            document.getElementById('IsoG').style.height = vid.height + ('px');
            document.getElementById('IsoG').style.clipPath = "polygon("+ (ti - (10 + st3)) +"% 91%,"+ (ti - (10 + st3)) +"% 13%,"+ (ti - (30 + st3)) +"% 13%,"+ (ti - (30 + st3)) +"% 91%)";
            vid.height = window.innerHeight * 0.9
        }, 10);
        
        //it breaks without delay
        setTimeout(function(){
            vid.currentTime = vid.duration - (percent * vid.duration)
        },5)
    </script>
</body>
</html>

<! based on code from https://www.reddit.com/r/learnjavascript/comments/c0b82m/map_cursor_position_to_video_time/?rdt=57406 !>